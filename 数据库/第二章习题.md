# 数据库第二章习题

## 课本习题

1. 试述关系模型的三个组成部分

   关系数据模型由**关系数据结构**、**关系操作集合**和**关系完整性约束**组成，分别描述了关系数据库系统的<u>静态特性</u>、<u>动态特性</u>和<u>完整性约束条件</u>

2. 简述关系数据语言的特点和分类

   特点：**集合**操作方式（面向集合）。

   分类：**代数方式**描述（关系代数）、**逻辑方式**描述（关系演算）——按照**谓词变元**的基本对象又可以分为元组关系演算和域关系演算。

3. 定义并理解下列术语，说明它们之间的联系和区别

   - 域、笛卡尔积、关系、元组、属性
   - 主码、候选码、外码
   - 关系模式、关系、关系数据库

   

   - 关系（relation）：一个关系对应通常所说的==一张表==，如上面这张学生登记表

   - 关系模式：就是关系的描述。

   - 关系数据库：给定的应用领域中，所有关系的集合就被称为是关系数据库。

   - 元组（tuple）：**表中的一行**即为一个元组

   - 属性（attribute）：表中的一列即为一个属性，给每一个属性起一个名字即为属性名

   - 码（key）：是表中的某一个属性组，用其可以唯一确定一个元组，如图中的学号就是本关系的一个码，**候选码**是表中可以唯一确定一个元组的属性组（可能有多个），而主码则是候选码中被选取出来唯一标识元组的候选码。

   - **外码/外键**：关系R的一个**属性组**，它*不是R的候选码*，但它与另一个关系S的候选码相对应，则称这个属性为R的外码

     举例：“合同”关系中的<u>客户号</u>不是候选码，但是它却是“客户”关系中的候选码，所以它是“合同”关系的外码

     ==两个关系通常是通过**外码**连接起来的==

   - 域（domain）：域是一组具有相同的数据类型的**值**的集合。属性的取值范围来自某个域，比如大学生年龄的集合就是（15-45岁），性别的集合就是（男，女）。

4. 举例说明关系模式和关系的区别

   关系是元组的集合，比方说现实世界的一张表，而关系模型则是关系的结构描述，比方说表的顶行属性组

5. 试述关系模型的完整性规则。在参照完整性中，什么情况下外码属性的值可以为空值

   1. 实体完整性**：关系的主码中的属性不能为空值（不知道或者无意义的值），否则元组不可标识，在关系模型中一般用‘?’表征
   
      数据库中出现空值，会影响许多方面，如影响聚集函数运算的正确性，不能参与算数、比较、逻辑运算等等
   
      有空值的时候是需要特殊处理的，这点需要特别注意	
   
   2. **参照完整性**：如果关系R1的**外码**Fk与关系R2的**主码**Pk相对应，则R1中的每一个元组中的Fk值要么等于R2中某个元组的Fk值，要么为空值。（下面举一个例子来理解一下）
   
      | <u>S#</u> | Sname | Ssex |  D#  |
      | :-------: | :---: | :--: | :--: |
      | 98030101  | 张三  |  男  |  01  |
      | 98030102  | 李四  |  男  |  02  |
      | 98030103  | 王五  |  男  |      |
   
      | <u>D#</u> | Dname  | Dean |
      | :-------: | :----: | :--: |
      |    01     |  机电  | 张三 |
      |    02     |  能源  | 李四 |
      |    03     | 计算机 | 李五 |
   
      - 空值：表示该学生尚未分配到任何系中
   
      - 若非空值：则必须是Dept关系的某个元组的D#值，因为学生不可能被分配到一个不存在的系里
   
   3. **用户自定义完整性**：用户针对具体的应用环境定义的完整性约束条件（比如约束性别只能是男/女等），就是约束值域范围
   
   ==实体完整性和参照完整性一般由DBMS系统自动提供（结构保证，无法保存/更新）==
   
   关于DBMS通常提供的机制
   
   - 使用户可以自定义有关的完整性约束条件
   - 当有更新操作发生的时候，DBMS将自动按照完整性约束条件检验更新操作的正确性，即是否符合用户自定义的完整性

## ER转换关系表作业

1. 有一个ER图，包含3个实体集，2个联系，请问该ER图最多可以转换成多少个关系表，最少可以转换成多少个，为什么？

   - 最多：5个，每个实体集一个关系，加上两个多对多联系。
   - 最少：3个，每个实体集一个关系，加上两个一对一或者一对多关系（合并到多的那一侧）

2. ![](https://wwt13-images-1305051431.cos.ap-beijing.myqcloud.com/img/20220321123540.png)

   首先是5个实体集关系+营业员实体集关系（合并）+管理员实体集关系（合并管理）

   商品

   | <u>商品编号</u> | 名称 | 类别 | 单位 | 单价 |
   | --------------- | ---- | ---- | ---- | ---- |

   供应商

   | <u>供应商编号</u> | 名称 | 账号 | 地址 |
   | ----------------- | ---- | ---- | ---- |

   仓库

   | <u>仓库编号</u> | 地址 | 负责人 |
   | --------------- | ---- | ------ |

   门店

   | <u>门店编号</u> | <u>名称</u> | <u>地址</u> |
   | --------------- | ----------- | ----------- |

   采购员

   | <u>采购员编号</u> | <u>姓名</u> | <u>业绩</u> |
   | ----------------- | ----------- | ----------- |

   管理员

   | <u>管理员编号</u> | <u>姓名</u> | <u>业绩</u> | <u>仓库编号（外键）</u> |
   | ----------------- | ----------- | ----------- | ----------------------- |

   营业员

   | <u>营业员编号</u> | <u>姓名</u> | <u>业绩</u> | <u>门店编号（外键）</u> |
   | ----------------- | ----------- | ----------- | ----------------------- |

   

   采购员、供应商、商品之间的三元多对多关系

   | <u>采购员编号</u> | <u>供应商编号</u> | <u>商品编号</u> |
   | ----------------- | ----------------- | --------------- |

   供应商、商品、仓库之间的三元多对多关系

   | <u>供应商编号</u> | <u>商品编号</u> | <u>仓库编号</u> |
   | ----------------- | --------------- | --------------- |

   商品、营业员、门店之间的三元多对多关系

   | <u>商品编号</u> | <u>营业员编号</u> | <u>门店编号</u> |
   | --------------- | ----------------- | --------------- |

   商品、门店、仓库之间的三元多对多关系

   | <u>商品编号</u> | <u>门店编号</u> | <u>仓库编号</u> |
   | --------------- | --------------- | --------------- |

   商品和仓库之间的二元多对多关系

   | <u>商品编号</u> | <u>仓库编号</u> |
   | --------------- | --------------- |

   