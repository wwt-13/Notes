# 数据库第五次作业

1.   什么是索引（此处是我的数据库笔记节选）

## 索引

> 关系数据库中，如果有上万甚至上亿条记录的话，在查找记录的时候，还想获得非常快的速度，就需要使用==索引==
>
> 索引是关系数据库中对某一列或者多个列的值进行预排序的数据结构。
>
> 通过使用索引，可以让数据库系统不必扫描整个表，而是可以直接定位到符合条件的记录，大大加快查询速度。

对于`students`表，如果要经常对`score`列进行查询，就可以对`score`列创建索引

```mysql
# 创建时添加索引
index index_score(score) # 和添加主键类似，同样可以添加多个
alter table student add index idx_score(score) # 对score列创建了一个名称为idx_score的索引，如果要对多列创建索引，那么只需要在括号里放上多个列名即可
```

对于主键，关系数据库会自动对其创建主键索引（效率高，因为主键保证了绝对唯一性）

### 唯一索引

> 设计关系数据表的时候，看上去唯一的列，例如身份证号、邮箱地址，但是因为他们具备业务含义（身份证号和邮箱都**有可能会修改**），所以不宜作为主键
>
> 但是这些列根据业务要求，又同时具备了唯一性约束，这种时候，就可以给这些列添加一个唯一索引
>
> 注意：MySql对于唯一索引不区分大小写

```mysql
alter table students add unique index uni_name(name);
# 也可以只对某一列添加一个唯一约束而不创建唯一索引
alter table students add constraint uni_name unique(name);
```

---

> 无论是否创建索引，对于用户和应用程序来说，使用关系数据库不会有任何区别。这里的意思是说，当我们在数据库中查询时，如果有相应的索引可用，数据库系统就会自动使用索引来提高查询效率，如果没有索引，查询也能正常执行，只是速度会变慢。因此，***索引可以在使用数据库的过程中逐步优化***。

2.   简述B树索引、Hash索引及聚簇索引的实现原理和优缺点

-   hash索引

    哈希表是一种以键 - 值（key-value）存储数据的结构，我们只要输入待查找的键即 key，就可以找到其对应的值即 Value。哈希的思路很简单，把值放在数组里，用一个哈希函数把 key 换算成一个确定的位置，然后把 value 放在数组的这个位置。不可避免地，多个 key 值经过哈希函数的换算，会出现同一个值的情况。处理这种情况的一种方法是，拉出一个链表

    优点：速度会很快，只需要往后追加。

    缺点：

    1.   Hash 索引仅仅能满足"=",“IN"和”<=>"查询，不能使用范围查询，无法被用来避免数据的排序操作
    2.   Hash 索引不能利用部分索引键查询
    3.   Hash 索引在任何时候都不能避免表扫描
    4.   Hash 索引遇到大量Hash值相等的情况后性能变慢

-   B树索引

    基于平衡二叉树实现的一种查询方法

    B- 树索引实现类似于倒置的树的结构，包括根节点、分支节点和叶子节点，并使用树遍历算法来搜索列值

    1.   分支节点包含叶子节点目录以及存储在其中的叶子节点的范围
    2.   根节点包含分支节点目录以及这些分支节点所包括的值的范围
    3.   索引的高度是指根数据块到叶子块的分支层次数目
    4.   索引的二元高度（BLEVEL）即索引高度 - 1

    优点：B树的每一个节点都包含key和value，因此经常访问的元素可能离根节点更近，因此访问也更迅速

    缺点：**会产生大量的随机IO**，随着新数据的插入，叶子节点会慢慢分裂，逻辑上连续的叶子节点在物理上往往不连续，甚至分离的很远，但做范围查询时，会产生大量读随机IO

-   聚簇索引

    聚簇索引也叫簇类索引，是一种对磁盘上实际数据重新组织以按指定的一个或多个列的值排序。 由于聚簇索引的索引页面指针指向数据页面，所以使用聚簇索引查找数据几乎总是比使用非聚簇索引快。

    优点：就是提高数据访问性能。

    缺点：维护索引很昂贵，特别是插入新行或者主键被更新导至要分页(page split)的时候。

3.   试述查询优化的作用和一般步骤

     作用：显然是为了提高查询的速度和效率

     1.   选取最适用的字段属性
     2.   使用连接（JOIN）来代替子查询(Sub-Queries)
     3.   使用联合(UNION)来代替手动创建的临时表
     4.   使用索引