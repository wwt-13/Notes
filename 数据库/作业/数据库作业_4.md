1. ![[CleanShot 2023-03-10 at 09.21.33.png]]
   1. $\Pi_{SNO}(\sigma_{JNO='J1'}SPJ)$
   2. $\Pi_{SNO}(\sigma_{JNO='J1' \wedge PNO='P1'}SPJ)$
   3. $\Pi_{SNO}\big( \sigma_{COLOR='çº¢' \wedge JNO='J1'}(P\bowtie SPJ \bowtie J )\big)$
   4. $\Pi_{JNO}\big(P\bowtie SPJ \bowtie S-\sigma_{COLOR='çº¢' \wedge CITY='å¤©æ´¥'}(P\bowtie SPJ \bowtie S)\big)$
   5. $\Pi_{JNO,PNO}SPJ \div \Pi_{PNO}\big(\sigma_{SNO='S1'}(P\bowtie SPJ)\big)$
2. è¯•è¿°ç­‰å€¼è¿æ¥ä¸è‡ªç„¶è¿æ¥çš„åŒºåˆ«å’Œè”ç³»
   1. ç­‰å€¼è¿æ¥ï¼šæ˜¯$\theta-è¿æ¥$çš„å˜ç§ï¼Œæ ¹æ®åˆ—çš„å€¼ç›¸ç­‰è¿›è¡Œè¿æ¥(åˆ—åè‡ªå·±æŒ‡å®šä¸”ä¸è¦æ±‚åˆ—åç›¸åŒ)
   2. è‡ªç„¶è¿æ¥ï¼šæ˜¯ä¸€ç§ç‰¹æ®Šçš„ç­‰å€¼è¿æ¥ï¼Œä¸éœ€è¦æŒ‡æ˜è¿æ¥æ¡ä»¶ï¼Œä¼šä¾æ®å…³ç³»ä¸­ç›¸åŒçš„å±æ€§ç»„è¿›è¡Œè¿æ¥(å±æ€§å+å€¼ç›¸ç­‰)
3. å…³ç³»ä»£æ•°çš„åŸºæœ¬è¿ç®—æœ‰å“ªäº›ï¼Ÿå¦‚ä½•ç”¨è¿™äº›åŸºæœ¬è¿ç®—æ¥è¡¨ç¤ºå…¶ä»–è¿ç®—ï¼Ÿ
   1. åŸºæœ¬è¿ç®—ï¼šå¹¶$\cup$ã€å·®$-$ã€ç¬›å¡å°”ç§¯$\times$ã€é€‰æ‹©$\sigma$ã€æŠ•å½±$\Pi$ã€æ›´å
   2. å…³ç³»ä»£æ•°æ‹“å±•æ“ä½œï¼šäº¤$\cap$ã€theta-è¿æ¥$\theta$ã€è‡ªç„¶è¿æ¥
      1. $A\cap B=A-(A\cup B)$
      2. $\mathop{R\bowtie S} \limits_{a\theta b}=\sigma_{a\theta b}(R\times S)$
      3. è‡ªç„¶è¿æ¥çš„è¯å°†$\theta-è¿æ¥$çš„é€‰æ‹©è¿ç®—æ”¹ä¸ºç­‰å€¼è¿æ¥+åˆ—åç›¸åŒå³å¯
   3. å…³ç³»ä»£æ•°å¤æ‚æ‹“å±•ï¼šé™¤ã€å¤–è¿æ¥ï¼ˆæš‚æ—¶ä¸ä¼šğŸ™…ğŸ»â€â™€ï¸ï¼‰
4. ![[CleanShot 2023-03-15 at 11.20.19.png]]
   1. æ‰¾å‡ºæ‰€æœ‰é¡¾å®¢ã€ä»£ç†å•†å’Œå•†å“éƒ½åœ¨åŒä¸€ä¸ªåŸå¸‚çš„ä¸‰å…ƒç»„(cid,aid,pid)
      $$
          \Pi_{CID,aID,Pid}(Customers \bowtie Agents \bowtie products)
      $$

   2. æ‰¾å‡ºæ‰€æœ‰é¡¾å®¢ã€ä»£ç†å•†å’Œå•†å“ä¸¤ä¸¤ä¸åœ¨åŒä¸€ä¸ªåŸå¸‚çš„ä¸‰å…ƒç»„(cid,aid,pid)
      $$
          \mathop{Customers \bowtie Agents}\limits_{Customer.City!=Agents.City} \bowtie products
          -
          \mathop{(\mathop{Customers \bowtie Agents}\limits_{Customer.City!=Agents.City}) \bowtie products}\limits_{Customer.City=products.City}-
          
          \mathop{(\mathop{Customers \bowtie Agents}\limits_{Customer.City!=Agents.City}) \bowtie products}\limits_{Agents.City=products.City}
      $$

   3. å–å‡ºè‡³å°‘è¢«ä¸€ä¸ªåœ¨æ­å·çš„é¡¾å®¢é€šè¿‡ä½äºä¸Šæµ·çš„ä»£ç†å•†å®šè´­çš„å•†å“çš„åå­—
      $$
       	\Pi_{Pname}(\mathop{Customers\bowtie Agents}\limits_{Customers.City='Hangzhou'\wedge Agents.City='Shanghai'}\bowtie Orders)\bowtie products)
      $$

   4. åˆ—å‡ºæ‰€æœ‰åœ¨åŒä¸€ä¸ªåŸå¸‚çš„ä»£ç†å•†çš„aidå¯¹
      $$
          \mathop{Agents\bowtie \rho_{agents}Agents}\limits_{Agents.aID!=agents.aID\wedge Agents.City=agents.City}
      $$

   5. å–å‡ºé”€å”®è¿‡æ‰€æœ‰æ›¾è¢«é¡¾å®¢c002å®šè´­è¿‡çš„å•†å“çš„ä»£ç†å•†çš„åå­—
      $$
          \Pi_{aname,Pid}(Orders \bowtie Agents) \div \Pi_{Pid}(\sigma_{cid='c002'}(Customers \bowtie Orders \bowtie Agents))
      $$

   6. å–å‡ºæ‰€æœ‰çš„ä¸‰å…ƒç»„ï¼ˆcidï¼Œaidï¼Œpidï¼‰ï¼Œè¦æ±‚å¯¹åº”çš„é¡¾å®¢ï¼Œä»£ç†å•†å’Œå•†å“ä¸­è‡³å°‘æœ‰ä¸¤è€…æ˜¯ä½äºåŒä¸€åº§åŸå¸‚
      $$
          Customers\bowtie Agents\bowtie products-\mathop{Customers\bowtie Agents\bowtie products}\limits_{cid=aid=pid}-\mathop{Customers\bowtie Agents\bowtie products}\limits_{cid\neq aid\neq pid}
      $$

   7. å–å‡ºæ¥å—è¿‡ä¸Šæµ·çš„é¡¾å®¢ä¸€ç¬”æ€»é¢è¶…è¿‡ï¿¥500çš„è®¢å•çš„ä»£ç†å•†çš„aidå€¼
      $$
          \Pi_{aid}(\sigma_{Customers.City='ä¸Šæµ·'\wedge price*Qty\ge500}(Customers\bowtie Orders\bowtie Products))
      $$

   8. å–å‡ºåªä»ä¸€å®¶ä»£ç†å•†å¤„å®šè´­è¿‡å•†å“çš„é¡¾å®¢çš„cidå€¼
      $$
          \Pi_{cid}(Orders)-\Pi_{cid}(\mathop{Orders\bowtie \rho_{orders}Orders}\limits_{Orders.aid\neq orders.aid})
      $$
