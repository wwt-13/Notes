[toc]

# C输入输出

## scanf&printf

## getchar&putchar

>   `putchar`很简单，就是非常单纯的输出一个指定字符，比如`putchar('\n')`
>
>   `getchar`比较复杂，需要深入理解
>
>   ```c
>   int getchar(void);
>   int putchar(int c);
>   ```

在用户键入**回车**之后，`getchar`才会从*缓冲区*中读入一个字符，返回值类型是int，读入成功返回读入字符的ASCII值，失败则返回-1

`getchar`==可以读入回车==，并且***如果用户再按回车之前输入了不止一个字符，那么其他字符会保留在缓冲区中，等待后续输入函数读取***

## gets&puts

>   `gets`和`puts`都是用于字符串输入输出的，相较于scanf，`gets`可以*读取带空格的字符串*
>
>   但是相比于`fgets`和`fputs`，`gets`和`puts`有较大的安全问题，不建议使用

-   `char* gets(char *str)`

    从缓冲区中读取一个字符串，可以读取空白符，以换行符为结束标志（不会讲换行符读取），并且输入的字符串会自动在字符串的末尾加上`\0`（**如果长度超出或等于字符数组申请空间，则无法在末尾添加`\0`，容易导致程序出现bug**）

    *<font color="red">Attention:</font>该方法已经逐渐被放弃使用，因为gets不会限制输入字符串字符的个数，如果读取长度超出了申请空间，就会导致缓冲区溢出，error，并且黑客也会利用这点插入一些破坏系统安全的代码*

-   `int puts(char *str)`

    输出一个字符串并***自动加上换行符***，该字符串必须以`\0`作为结尾

## fgets&fputs

>   推荐使用的字符串输入输出函数

-   `int fputs(const char *s, FILE *stream)`

    -   参数1：要输出的字符串
    -   参数2：字符串输出位置（标准输出位stdout）

-   `char* fgets(char *s, int n, FILE *stream) `

    -   参数1：输入数据的存放位置

    -   参数2：读入字符的最大数量-1（因为fgets会自动在末尾添加`\0`，~~并且如果字符串数组能够存下，fgets还会在末尾添加`\n`，也就是同时添加`\n\0`，此时推荐将参数2设置为字符数组大小+1~~）

        *<font color="red">Attention:</font>上面的删除内容结果没问题，但是逻辑有问题，fgets读取的字符串末尾存在换行符是因为fgets可以读取输入缓冲区的换行符，而不是fgets自动添加，具体可以看看以下示例*

        *<font color="orange">Tip:</font>很多时候都建议奖fgets和getchar搭配使用，读取之前输入缓冲区中的换行符*

        ```c
        #include <stdio.h>
        #include <stdlib.h>
        #include <string.h>
        int main()
        {
            char name[10];
            char c;
            for (int i = 0; i < 3; i++)
            {
                fgets(name, 10, stdin);
                c = getchar();
                printf("%s %zd %c", name, strlen(name), c);
            }
            return 0;
        }//注意要对该程序的运行结果仔细思考！！！
        ```
    
        ![CleanShot 2022-09-16 at 09.00.07](/Users/wwt13/Documents/Notes/assets/CleanShot 2022-09-16 at 09.00.07.gif)
    
    -   参数3：输入字符来源位置（标准输入为`stdin`）
    
    和gets类似，可以读取*空白符号*

## fputc&fgetc

>   以字符形式读写指定文件

-   `int fgetc(FILE *fp)`读取成功返回读取到的字符，读取到文件末尾或者读取失败返回EOF

    *<font color="orange">Tip:</font>为什么这些函数都要返回int类型的值，就是因为EOF是在stdio.h头文件中定义的宏，它的值是一个负数，而char类型无法容纳负数* 

-   `int fputc(int ch,FILE *fp)`向指定文件中写入一个字符，成功返回写入的字符，失败返回EOF

## fprintf&fscanf

>   格式化读写文件的方式，和printf&scanf的格式及其类似，仅仅多了一个文件指针参数。

-   `int fprintf(FILE *fp,char *format,...)`
-   `int fscanf(FILE *fp,char *format,...)`

---



>   在C语言中，操作文件必须先打开文件，所谓打开文件，就是让程序和文件建立连接的过程。
>
>   打开文件之后，程序可以得到*文件的相关信息，例如大小、类型、权限、创建者、更新时间等*。在后续读写文件的过程中，程序还可以记录当前读写到了哪个位置，下次可以在此基础上继续操作。
>
>   使用`stdio.h`头文件中的`fopen()`函数即可打开文件。
>
>   ```c
>   FILE *fopen(char *filename,char *mode);
>   ```
>
>   *<font color="green">Ps:</font>要注意的是filename和mode均为字符串*
>
>   *<font color="green">Ps:</font>此处我们讨论的一般为文本文件*

`fopen()`会获取文件信息，包括文件名、文件状态、当前读写位置等，并将这些信息保存到一个 ***FILE 类型的结构体变量***中，然后将该变量的地址返回（如果打开文件失败，会返回一个空指针NULL）

***文本打开方式（mode）***

| 打开方式 |                             说明                             |
| :------: | :----------------------------------------------------------: |
|   "r"    | 以“只读”方式打开文件。只允许读取，不允许写入。文件必须存在，否则打开失败。 |
|   "w"    | 以“写入”方式打开文件。如果文件不存在，那么创建一个新文件；如果文件存在，那么清空文件内容（相当于删除原文件，再创建一个新文件）。 |
|   "a"    | 以“追加”方式打开文件。如果文件不存在，那么创建一个新文件；如果文件存在，那么将写入的数据追加到文件的末尾（文件原有的内容保留）。 |
|   "r+"   | 以“读写”方式打开文件。既可以读取也可以写入，也就是随意更新文件。文件必须存在，否则打开失败。 |
|   "w+"   | 以“写入/更新”方式打开文件，相当于`w`和`r+`叠加的效果。既可以读取也可以写入，也就是随意更新文件。如果文件不存在，那么创建一个新文件；如果文件存在，那么清空文件内容（相当于删除原文件，再创建一个新文件）。 |
|   "a+"   | 以“追加/更新”方式打开文件，相当于a和r+叠加的效果。既可以读取也可以写入，也就是随意更新文件。如果文件不存在，那么创建一个新文件；如果文件存在，那么将写入的数据追加到文件的末尾（文件原有的内容保留）。 |

文件使用完毕后，必须使用`fclose()`函数将文件关系，释放资源以避免数据都是

```c
int fclose(FILE *fp);
//正常关闭返回值为0，非零值则代表有错误发生
```

***文件读写的基本格式***

```c
#include<stdio.h>
#include<stdlib.h>
#define N 100
int main(){
    FILE *fp;
    char line[N+1];
    if((fp=fopen("./1.txt","r"))==NULL){
        printf("文件打开失败\n");
        exit(0);
    }
    while(fgets(line,N,fp)!=NULL){
        printf("%s",line);
    }
    fclose(fp);
    return 0;
}
```

## 文本文件与二进制文件

>   首先明确一点，所有文件在计算机上的存储都是二进制的，所以***文本文件与二进制文件的区别不是物理上的，而是逻辑上的，两者只在编码层次上有差别***
>
>   简单来说，文本文件是基于字符编码的文件，比如ASCII编码、UTF-8编码、UNICODE编码等等，以ASCII编码为例，一个文件的前八位为`00100001`，那么对于文本文件它的含义就是***固定***的`!`字符。而对于二进制文件而言呢，它的含义是***由自己决定的***，也就是自定义编码，可能前四位代表了文件长度，后四位代表了文件信息。

*上面理解了文本文件与二进制文件的区别，下面就以读取一个二进制文件为例来理解文本工具打开一个文件的过程*

1.   文本工具读取文件的二进制比特流，比方说`01000000010000010100001001000011`
2.   文本工具按照你选择的解码方式来解释这个二进制比特流，比方说通过ASCII编码进行解码，那么`01000000_01000001_01000010_01000011`对应的就是`ABCD`
3.   当然，在二进制文件中，这一串比特流对应的可能就是一个4字节的整数。在世界上，任何东西和其他东西要传递信息都需要一个协议，在这里，ASCII编码就是这个协议，它约定了信息被编码成什么样的二进制比特流，也约定了二进制比特流被解码成什么信息（类比不同语言的交流）。



# ASCII编码对照表

|  二进制  | 十进制 | 十六进制 |                  字符/缩写                   |                解释                |
| :------: | :----: | :------: | :------------------------------------------: | :--------------------------------: |
| 00000000 |   0    |    00    |                  NUL (NULL)                  |               空字符               |
| 00000001 |   1    |    01    |           SOH (Start Of Headling)            |              标题开始              |
| 00000010 |   2    |    02    |             STX (Start Of Text)              |              正文开始              |
| 00000011 |   3    |    03    |              ETX (End Of Text)               |              正文结束              |
| 00000100 |   4    |    04    |          EOT (End Of Transmission)           |              传输结束              |
| 00000101 |   5    |    05    |                ENQ (Enquiry)                 |                请求                |
| 00000110 |   6    |    06    |              ACK (Acknowledge)               |         回应/响应/收到通知         |
| 00000111 |   7    |    07    |                  BEL (Bell)                  |                响铃                |
| 00001000 |   8    |    08    |                BS (Backspace)                |                退格                |
| 00001001 |   9    |    09    |             HT (Horizontal Tab)              |             水平制表符             |
| 00001010 |   10   |    0A    |          LF/NL(Line Feed/New Line)           |               换行键               |
| 00001011 |   11   |    0B    |              VT (Vertical Tab)               |             垂直制表符             |
| 00001100 |   12   |    0C    |          FF/NP (Form Feed/New Page)          |               换页键               |
| 00001101 |   13   |    0D    |             CR (Carriage Return)             |               回车键               |
| 00001110 |   14   |    0E    |                SO (Shift Out)                |              不用切换              |
| 00001111 |   15   |    0F    |                SI (Shift In)                 |              启用切换              |
| 00010000 |   16   |    10    |            DLE (Data Link Escape)            |            数据链路转义            |
| 00010001 |   17   |    11    |  DC1/XON (Device Control 1/Transmission On)  |         设备控制1/传输开始         |
| 00010010 |   18   |    12    |            DC2 (Device Control 2)            |             设备控制2              |
| 00010011 |   19   |    13    | DC3/XOFF (Device Control 3/Transmission Off) |         设备控制3/传输中断         |
| 00010100 |   20   |    14    |            DC4 (Device Control 4)            |             设备控制4              |
| 00010101 |   21   |    15    |          NAK (Negative Acknowledge)          |     无响应/非正常响应/拒绝接收     |
| 00010110 |   22   |    16    |            SYN (Synchronous Idle)            |              同步空闲              |
| 00010111 |   23   |    17    |       ETB (End of Transmission Block)        |       传输块结束/块传输终止        |
| 00011000 |   24   |    18    |                 CAN (Cancel)                 |                取消                |
| 00011001 |   25   |    19    |              EM (End of Medium)              | 已到介质末端/介质存储已满/介质中断 |
| 00011010 |   26   |    1A    |               SUB (Substitute)               |             替补/替换              |
| 00011011 |   27   |    1B    |                 ESC (Escape)                 |             逃离/取消              |
| 00011100 |   28   |    1C    |             FS (File Separator)              |             文件分割符             |
| 00011101 |   29   |    1D    |             GS (Group Separator)             |          组分隔符/分组符           |
| 00011110 |   30   |    1E    |            RS (Record Separator)             |             记录分离符             |
| 00011111 |   31   |    1F    |             US (Unit Separator)              |             单元分隔符             |
| 00100000 |   32   |    20    |                   (Space)                    |                空格                |
| 00100001 |   33   |    21    |                      !                       |                                    |
| 00100010 |   34   |    22    |                      "                       |                                    |
| 00100011 |   35   |    23    |                      #                       |                                    |
| 00100100 |   36   |    24    |                      $                       |                                    |
| 00100101 |   37   |    25    |                      %                       |                                    |
| 00100110 |   38   |    26    |                      &                       |                                    |
| 00100111 |   39   |    27    |                      '                       |                                    |
| 00101000 |   40   |    28    |                      (                       |                                    |
| 00101001 |   41   |    29    |                      )                       |                                    |
| 00101010 |   42   |    2A    |                      *                       |                                    |
| 00101011 |   43   |    2B    |                      +                       |                                    |
| 00101100 |   44   |    2C    |                      ,                       |                                    |
| 00101101 |   45   |    2D    |                      -                       |                                    |
| 00101110 |   46   |    2E    |                      .                       |                                    |
| 00101111 |   47   |    2F    |                      /                       |                                    |
| 00110000 |   48   |    30    |                      0                       |                                    |
| 00110001 |   49   |    31    |                      1                       |                                    |
| 00110010 |   50   |    32    |                      2                       |                                    |
| 00110011 |   51   |    33    |                      3                       |                                    |
| 00110100 |   52   |    34    |                      4                       |                                    |
| 00110101 |   53   |    35    |                      5                       |                                    |
| 00110110 |   54   |    36    |                      6                       |                                    |
| 00110111 |   55   |    37    |                      7                       |                                    |
| 00111000 |   56   |    38    |                      8                       |                                    |
| 00111001 |   57   |    39    |                      9                       |                                    |
| 00111010 |   58   |    3A    |                      :                       |                                    |
| 00111011 |   59   |    3B    |                      ;                       |                                    |
| 00111100 |   60   |    3C    |                      <                       |                                    |
| 00111101 |   61   |    3D    |                      =                       |                                    |
| 00111110 |   62   |    3E    |                      >                       |                                    |
| 00111111 |   63   |    3F    |                      ?                       |                                    |
| 01000000 |   64   |    40    |                      @                       |                                    |
| 01000001 |   65   |    41    |                      A                       |                                    |
| 01000010 |   66   |    42    |                      B                       |                                    |
| 01000011 |   67   |    43    |                      C                       |                                    |
| 01000100 |   68   |    44    |                      D                       |                                    |
| 01000101 |   69   |    45    |                      E                       |                                    |
| 01000110 |   70   |    46    |                      F                       |                                    |
| 01000111 |   71   |    47    |                      G                       |                                    |
| 01001000 |   72   |    48    |                      H                       |                                    |
| 01001001 |   73   |    49    |                      I                       |                                    |
| 01001010 |   74   |    4A    |                      J                       |                                    |
| 01001011 |   75   |    4B    |                      K                       |                                    |
| 01001100 |   76   |    4C    |                      L                       |                                    |
| 01001101 |   77   |    4D    |                      M                       |                                    |
| 01001110 |   78   |    4E    |                      N                       |                                    |
| 01001111 |   79   |    4F    |                      O                       |                                    |
| 01010000 |   80   |    50    |                      P                       |                                    |
| 01010001 |   81   |    51    |                      Q                       |                                    |
| 01010010 |   82   |    52    |                      R                       |                                    |
| 01010011 |   83   |    53    |                      S                       |                                    |
| 01010100 |   84   |    54    |                      T                       |                                    |
| 01010101 |   85   |    55    |                      U                       |                                    |
| 01010110 |   86   |    56    |                      V                       |                                    |
| 01010111 |   87   |    57    |                      W                       |                                    |
| 01011000 |   88   |    58    |                      X                       |                                    |
| 01011001 |   89   |    59    |                      Y                       |                                    |
| 01011010 |   90   |    5A    |                      Z                       |                                    |
| 01011011 |   91   |    5B    |                      [                       |                                    |
| 01011100 |   92   |    5C    |                      \                       |                                    |
| 01011101 |   93   |    5D    |                      ]                       |                                    |
| 01011110 |   94   |    5E    |                      ^                       |                                    |
| 01011111 |   95   |    5F    |                      _                       |                                    |
| 01100000 |   96   |    60    |                      `                       |                                    |
| 01100001 |   97   |    61    |                      a                       |                                    |
| 01100010 |   98   |    62    |                      b                       |                                    |
| 01100011 |   99   |    63    |                      c                       |                                    |
| 01100100 |  100   |    64    |                      d                       |                                    |
| 01100101 |  101   |    65    |                      e                       |                                    |
| 01100110 |  102   |    66    |                      f                       |                                    |
| 01100111 |  103   |    67    |                      g                       |                                    |
| 01101000 |  104   |    68    |                      h                       |                                    |
| 01101001 |  105   |    69    |                      i                       |                                    |
| 01101010 |  106   |    6A    |                      j                       |                                    |
| 01101011 |  107   |    6B    |                      k                       |                                    |
| 01101100 |  108   |    6C    |                      l                       |                                    |
| 01101101 |  109   |    6D    |                      m                       |                                    |
| 01101110 |  110   |    6E    |                      n                       |                                    |
| 01101111 |  111   |    6F    |                      o                       |                                    |
| 01110000 |  112   |    70    |                      p                       |                                    |
| 01110001 |  113   |    71    |                      q                       |                                    |
| 01110010 |  114   |    72    |                      r                       |                                    |
| 01110011 |  115   |    73    |                      s                       |                                    |
| 01110100 |  116   |    74    |                      t                       |                                    |
| 01110101 |  117   |    75    |                      u                       |                                    |
| 01110110 |  118   |    76    |                      v                       |                                    |
| 01110111 |  119   |    77    |                      w                       |                                    |
| 01111000 |  120   |    78    |                      x                       |                                    |
| 01111001 |  121   |    79    |                      y                       |                                    |
| 01111010 |  122   |    7A    |                      z                       |                                    |
| 01111011 |  123   |    7B    |                      {                       |                                    |
| 01111100 |  124   |    7C    |                      \|                      |                                    |
| 01111101 |  125   |    7D    |                      }                       |                                    |
| 01111110 |  126   |    7E    |                      ~                       |                                    |
| 01111111 |  127   |    7F    |                 DEL (Delete)                 |                删除                |
