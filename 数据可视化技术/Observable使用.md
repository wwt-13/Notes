[toc]

# Observable使用

## 基础概念了解

>   在介绍 Observable 之前，我们要先了解两个设计模式：
>
>   -   Observer Pattern - (观察者模式)
>   -   Iterator Pattern - (迭代器模式)

### Observer Pattern

**观察者模式**是*[软件设计模式](https://zh.wikipedia.org/wiki/軟件設計模式)*的一种。在此种模式中，<u>一个目标对象管理所有相依于它的观察者对象，并且在它本身的状态改变时主动发出通知</u>。这通常透过呼叫各观察者所提供的方法来实现。此种模式通常被用来<u>实时事件处理系统</u>。 

观察者模式又叫发布订阅模式（Publish/Subscribe），它定义了一种一对多的关系，让多个观察者对象同时监听某一个主题对象，<u>这个主题对象的状态发生变化时就会通知所有的观察者对象，使得它们能够自动更新自己</u>

-   **优点**：简单的广播通信，自动通知所有已经订阅过的对象
-   **缺点**：👇🏻
    1.   如果一个被观察者对象有很多的直接和间接的观察者的话，将所有的观察者都通知到会花费很多时间
    2.   如果在观察者和观察目标之间有**循环依赖**的话，观察目标会触发它们之间进行循环调用，可能导致系统崩溃

### Iterator Pattern

>   迭代器（Iterator）模式，又叫做游标（Cursor）模式。它提供一种方法顺序访问一个聚合对象中的各个元素，而又不需要暴露该对象的内部表示。迭代器模式可以把迭代的过程从业务逻辑中分离出来，在使用迭代器模式之后，即使不关心对象的内部构造，也可以按顺序访问其中的每个元素。

-   **优点**：
    1.   大大简化了遍历方式，诸如hash表之类的遍历在迭代器模式下非常简单
    2.   封装性良好
-   **缺点**：遍历过程是单向不可逆

一个迭代器对象 ，知道如何每次访问集合中的一项， 并记录它的当前在序列中所在的位置。在 JavaScript 中迭代器是一个对象，它提供了一个 next() 方法，返回序列中的下一项。这个方法返回包含 `done` 和 `value` 两个属性的对象。对象的取值如下

-   在最后一个元素前：`{ done: false, value: elementValue }`
-   在最后一个元素后：`{ done: true, value: undefined }`

