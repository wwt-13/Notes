# 第三次理论课作业

1. 一个32位的虚拟存储系统有两级页表，其逻辑地址中，第22到31位是第一级页表，12位到 21位是第二级页表，页内偏移占0到11位。一个进程的地址空间为4GB，如果从0x80000000 开始映射4MB大小页表空间，请问第一级页表所占4KB空间的起始地址?并说明理由。(注意B代表字节，一个32位地址占4字节)
   $$
   PD_{base}=PT_{base}+PT_{base}>>10
   $$
   首先，对于虚拟空间而言，第n个页表项对应了第n个页表，所以对于第一个页表项(0x80000000),该页表项所在的页被第PN=PT_base>>12个页表项映射，又由于页表自映射的特性，该页表项所在的位置就是PD_base

   所以，PD_base=PT_base+(PT_base>>12)*4,由此得到该页目录的起始地址为：0x80200000

2. 一个32位的虚拟存储系统有两级页表，其逻辑地址中，第22到31位是第一级页表(页目录) 的索引，第12位到21位是第二级页表的索引，页内偏移占第0到11位。每个页表(目录) 项包含20位物理页框号和12位标志位，其中最后1位为页有效位。

   1. 请问进程整个的地址空间有多少字节?一页有多少字节?
      `4GB`,`4KB`
   2. 如果当前进程的页目录物理基地质、页目录和相应页表内容如图下所示，请描述访问以下虚拟地址时系统进行地址转换的过程，如可行给出最终访存获取到的数据。虚拟地址:0x0、0x00803004、0x00402001
      - 虚拟地址 0x0：虚拟页目录号为0，查询对应0号页目录项，得到页目录项0x0，由于有效标志位为 0，表示该页面无效，因此页表中不存在该虚拟地址到物理地址的映射，产生缺页中断
      - 虚拟地址 0x00803004：虚拟页目录索引号为 2，二级页表索引号为 3，页内偏移为 4，查询对应 2 号页目录项，得到 0x5001，有效标志位为 1，在物理地址 0x5000 查找二级页表，找到对应的 3 号页表项，0x20001，由于有效标志位为 1，对应物理页框基地址为 0x20000，根据页内偏移 4，查找偏移地址为 4 的内存（第 5 个字节），得到数据 0x326001
      - 虚拟地址 0x00402001：虚拟页目录索引号为 1，二级页表索引号为 2，页内偏移为 1，查询对应 1 号页目录项，得到 0x1001，有效标志位为 1，在物理地址 0x1000 查找二级页表，即为页目录自身，找到对应的 2 号页表项，0x5001，由于有效标志位为 1，对应物理页框基地址为 0x5000，根据页内偏移 1（第二个字节），查找对应内存，得到数据 0x00
   3. 要想访问物理地址0x326028，需要使用哪个虚拟地址?
      0x00C01028，其中虚拟页目录索引号为 3，二级页表索引号为 1，页内偏移为 0x028