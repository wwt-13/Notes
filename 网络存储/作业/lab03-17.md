## Lab03 Ceph 存储集群实践

> 组号：17

|      |   学号   |  姓名  |
| :--: | :------: | :----: |
|  1   | 21371518 | 薛天钰 |
|  2   | 20373914 | 吴文韬 |
|  3   | 20373873 | 潘语依 |



## 实验内容

### **思考题1：查阅资料，谈谈对象存储和文件系统之间有哪些区别？**

1. **数据组织方式**：
   - **文件系统**：文件系统以文件和目录的层次结构来组织数据，文件被存储在目录中，可以通过路径来访问和管理文件。
   - **对象存储**：对象存储通过唯一的标识符来存储数据对象，每个对象包含数据本身、元数据和唯一的标识符。这些对象可以在一个扁平的命名空间中存储，而不需要传统文件系统中的层次结构。
2. **访问方式**：
   - **文件系统**：通过文件路径和目录结构进行访问，通常采用文件系统的API来读取、写入、修改和删除文件。
   - **对象存储**：对象存储通常使用 RESTful API 或者 SDK 来访问，通过唯一的标识符来获取、存储和管理对象，可以通过 HTTP 或者 HTTPS 进行访问。
3. **数据管理和存储规模**：
   - **文件系统**：适用于相对较小规模的数据存储和管理，通常部署在单个服务器或者本地存储系统上。
   - **对象存储**：更适用于大规模数据存储和管理，可横向扩展以处理大量数据，适合云存储和分布式存储场景。
4. **数据操作和持久性**：
   - **文件系统**：通常用于较小的文件读写操作，适合对文件的频繁更新和修改。
   - **对象存储**：更适合于大对象的读写和存储，对象一旦创建后，通常不会被修改，而是采用追加或者替换整个对象的方式进行更新。
5. **数据一致性和可用性**：
   - **文件系统**：通常提供较强的一致性和实时性，适用于需要即时更新和同步的应用场景。
   - **对象存储**：通常提供较高的可用性和容错性，在大规模分布式系统中能够更好地处理数据复制、故障恢复和数据冗余。
6. **适用场景**：
   - **文件系统**：适用于需要按照层次结构组织和访问数据的传统应用，如操作系统、应用程序和个人计算机。
   - **对象存储**：适用于需要大规模、持久化、高可用性和高性能的数据存储场景，如云存储、大数据分析、多媒体内容存储等。



### **任务1：集群安装完毕后，将 Dashboard 和 `ceph -s` 的结果截图**

![image-20231209165604205](/Users/wwt13/Documents/Notes/assets/image-20231209165604205.png)

### **思考题2：假设你管理一个含有 4 个 OSD 的生产集群，在满足上述条件的情况下，集群中的 PG 总数最多为多少？**

### **条件**：

- 每个OSD上的PG**至多100个**
- 每个PG**至少绑定3个不同的**OSD
- PG的数量为**2的幂**



#### 解答

**设PG数量为 `n`** 

 `n` 至少满足: 
$$
\begin{cases}
3 * n \leqslant 4 * 100 \\
n = 2^k \quad (k \in \mathbb{N})
\end{cases}
$$
容易得到: 
$$
\begin{cases}
n < 134 \\
n \leqslant 128
\end{cases}
$$
断言  $\pmb{n = 128}$

下面给出一种可能的设计方案:

>  将**128**个PG分为**4组**，每组32个，分别绑定
> 
> - {**OSD1**, **OSD2**, **OSD3**}
> 
> - {**OSD1**, **OSD2**, **OSD4**}
> 
> - {**OSD1**, **OSD3**, **OSD4**}
> 
> - {**OSD2**, **OSD3**, **OSD4**}

上述构造中

- 每个PG绑定**3**个不同的OSD

- 每个OSD上有3组PG共**96**个

满足三个条件，断言成立。故集群中的 PG 总数最多为128个。



### **任务2：在你的机器上执行 `df -h` 并将结果截图**

![CleanShot 2023-12-09 at 16.53.59](/Users/wwt13/Documents/Notes/assets/CleanShot 2023-12-09 at 16.53.59.png)



### **思考题3：MDS 元数据服务器的作用是什么？**

#### MDS 的主要作用：

1. **元数据管理：** MDS 负责存储和管理文件系统的元数据，包括目录结构、文件属性、文件权限、文件位置等信息。这些元数据描述了文件系统中文件和目录的组织结构和特征。
2. **命名空间管理：** 维护文件系统的命名空间，使得用户能够通过路径来定位和访问文件和目录。MDS 管理文件和目录之间的层次结构，允许用户按照路径名来操作文件系统。
3. **元数据的高可用性和容错性：** 在分布式的 Ceph 文件系统中，MDS 通常以多副本的方式部署，以确保元数据的高可用性和容错性。这样即使某个 MDS 节点出现故障，其他节点仍然能够提供服务。
4. **文件系统操作的协调和处理：** 处理文件系统操作，例如创建、删除、移动文件或目录等。MDS 负责确保这些操作在文件系统中正确执行并且是同步的。
