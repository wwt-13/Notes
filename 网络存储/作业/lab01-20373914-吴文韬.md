# Lab01

> 通过工具查看磁盘列表
>
> `lsblk -d`

```shell
NAME  MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
loop0   7:0    0 55.4M  1 loop /snap/core18/1944
loop1   7:1    0 55.6M  1 loop /snap/core18/2538
loop2   7:2    0   62M  1 loop /snap/core20/1587
loop3   7:3    0 69.9M  1 loop /snap/lxd/19188
loop4   7:4    0   47M  1 loop /snap/snapd/16292
sda     8:0    0   20G  0 disk
sdb     8:16   0    1G  0 disk
sdc     8:32   0    1G  0 disk
sdd     8:48   0    1G  0 disk
sde     8:64   0    1G  0 disk
sdf     8:80   0    1G  0 disk
sr0    11:0    1 1024M  0 rom
```

> 使用 LVM 扩展根目录/的容量
>
> `fdisk /dev/sda`给空闲的磁盘空间分区
> `pvcreate /dev/sda4`创建物理卷
> `vgextend ubuntu-vg /dev/sda4`将刚创建的物理卷加入卷组
> `lvextend -l +100%FREE /dev/ubuntu-vg/ubuntu-lv`逻辑卷扩容
> `resize2fs /dev/ubuntu-vg/ubuntu-lv`为文件系统扩容
>
> `df -lh /`查看扩容后的文件系统

```shell
Filesystem                         Size  Used Avail Use% Mounted on
/dev/mapper/ubuntu--vg-ubuntu--lv   20G  5.9G   12G  34% /
```

> Raid 阵列尝试

| Raid0                                            | Raid1                                            | Raid5                                                  | Raid10                                                 |
| ------------------------------------------------ | ------------------------------------------------ | ------------------------------------------------------ | ------------------------------------------------------ |
| mdadm -Cv /dev/md0 -a yes -n 2 -l 0 /dev/sd{b,c} | mdadm -Cv /dev/md1 -a yes -n 2 -l 1 /dev/sd{b,c} | mdadm -Cv /dev/md5 -a yes -n 5 -l 5 /dev/sd{b,c,d,e,f} | mdadm -Cv /dev/md10 -a yes -n 4 -l 10 /dev/sd{b,c,d,e} |

> Raid0 测试
>
> 发现 Raid0 阵列已损坏
> `mdadm: cannot open /dev/md0: No such file or directory`

> Raid1,5 测试
>
> 将数据写入 test 文件中`echo 'Hello, world' > /mnt/raid1/test`
> 模拟磁盘损坏`mdadm /dev/md1 -f /dev/sdb`
>
> 再次读取文件`cat /mnt/raid1/test`
>
> 正常输出，文件完好无损

> 为什么以及在什么条件下使用 Raid
>
> 为什么需要分 Raid 技术讨论

-   前提：至少有两块磁盘(最好是大小相同、同种类磁盘)，对于数据安全性有一定需求，或者对于数据读写性能有一定需求
-   组 RAID0: 可以大大提高数据的读写性能
-   组 RAID1: 可以大大提高数据的安全性
-   组 RAID5: 可以在一定程度上提高数据的安全性和读写性能(允许损坏一块磁盘)
-   组 RAID1+0: 可以在一定程度上提高数据的安全性和读写性能(最佳方案，也是存储设备厂商推荐的方案)

> RAID & 分布式存储 & 集中存储的区别

-   RAID: 通过多块磁盘组成阵列，提高数据的读写性能和安全性
-   分布式存储: 将数据分散存储在多个节点上，提高数据的读写性能和安全性
-   集中存储: 将数据集中存储在一个节点上，提高数据的读写性能和安全性
