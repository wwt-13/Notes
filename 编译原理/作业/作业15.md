# ä½œä¸š 15

> å°†ä»¥ä¸‹ä»£ç åˆ‡åˆ†ä¸ºåŸºæœ¬å—ï¼Œå¹¶ç”»å‡ºæµå›¾

```python
x=1
i=0
if i>=10 goto (7)
x=x*i
i=i+1
goto (3)
if x>5000 goto (11)
RETURN_VAL=5000
return
goto (13)
RETURN_VAL=x
return
return
```

å…·ä½“è§£ç­”è§å›¾ ğŸ‘‡ğŸ»
![Alt text](<CleanShot 2023-11-04 at 09.50.41.png>)

> æŒ‰ç…§ç®—æ³• 14.2 ä¸ºå›¾ä¸­æ‰€ç¤ºä»£ç åºåˆ—å»ºç«‹ DAG å›¾ï¼Œå¹¶è¯¦è¿°æ„å»ºè¿‡ç¨‹
>
> ä»£ç åºåˆ—
> t1=-c
> t2=b\*t1
> t3=-c
> c=b\*t3
> t4=t2+c
> a=t4

ä»¥`<-`ä»£è¡¨è¾¹ï¼Œ`[xxx]`ä»£è¡¨ xxx è¿ç®—

| expression | DAG                             | node table                                                           |
| ---------- | ------------------------------- | -------------------------------------------------------------------- |
| t1=-c      | t1<-[-]<-c_0                    | {t1=>t1,c_0=>c_0}                                                    |
| t2=b\*t1   | t1<-[\*]<-t1<-[-]<-c_0          | { t1=>t1, t2=>t2, c_0=>c_0, b_0=>b_0 }                               |
| t3=-c      | t2<-[\*]<-t1<-[-]<-c_0          | { t1=>t1, t2=>t2, t3=>t1, c_0=>c_0, b_0=>b_0 }                       |
| c=b\*t3    | t2<-[\*]<-t1<-[-]<-c_0          | { t1=>t1, t2=>t2, t3=>t1, c_0=>c_0, c_1=>t2, b_0=>b_0 }              |
| t4=t2+c    | t4<-[+]<-t2<-[\*]<-t1<-[-]<-c_0 | { t1=>t1, t2=>t2, t3=>t1, t4=>t4, c_0=>c_0, c_1=>t2, b_0=>b_0}       |
| a=t4       | t4<-[+]<-t2<-[\*]<-t1<-[-]<-c_0 | { t1=>t1, t2=>t2, t3=>t1, t4=>t4, c_0=>c_0, c_1=>t2, b_0=>b_0,a=>t4} |

æœ€ç»ˆ DAG å›¾ä¸º

```
     v----\
t4<-[+]<-t2<-[*]<-t1<-[-]<-c_0
              ^----b_0
```

> ä¸ºä»¥ä¸‹å››å…ƒå¼åºåˆ—æ„å»º DAG å›¾ï¼Œå¹¶é‡‡ç”¨ç®—æ³• 14. 3 æ‰€ä»‹ç»çš„å¯å‘å¼ç®—æ³•é‡æ–°å¯¼å‡ºä¸­é—´ä»£ç ï¼Œéœ€ç®€è¿°ä¸­é—´ä»£ç çš„å¯¼å‡ºè¿‡ç¨‹
>
> t1=a
> t2=t1\*2
> b=a
> t3=b\*2
> t4:=t2+t3
> a:=t4
> t5=t1\*2
> t6=b+t5
> b=t6

å¯¼å‡ºä»£ç 

```
t2=a_0*2
t4=t2+t2
t6=a_0+t2
```

å¯¼å‡ºä¸­é—´èŠ‚ç‚¹åºåˆ—

```
[]
[a_0]
[a_0,2]
[a_0,2,t2]
[a_0,2,t2,t4]
[a_0,2,t2,t4,t6]
```

å˜é‡è¡¨

```
{
    a_0=>a_0,
    t1=>a_0,
    t2=>t2,
    b_0=>a_0,
    t3=>t2,
    t4=>t4,
    a_1=>t4,
    t5=>t2,
    t6=>t6,
    b_1=>t6
}
```

DAG å›¾

```
     v----\
t4<-[+]<-t2<-[*]<-----a_0
              ^----2  /
  t6<-[+]<------------/
```

> é™„åŠ é¢˜ï¼šåˆ†æ bitset.c ä¸­å¯ä¼˜åŒ–çš„ç‚¹

```c
#include <stdio.h>
#include <time.h>
int set(int a[], int pos, int d)
{
    const int bitcount = 30;

    int x[31] = {};

    x[0] = 1;

    x[1] = x[0] * 2;

    x[2] = x[1] * 2;

    x[3] = x[2] * 2;

    x[4] = x[3] * 2;

    x[5] = x[4] * 2;

    x[6] = x[5] * 2;

    x[7] = x[6] * 2;

    x[8] = x[7] * 2;

    x[9] = x[8] * 2;

    x[10] = x[9] * 2;

    int i = 10;

    while (i < bitcount)
    {

        i = i + 1;

        x[i] = x[i - 1] * 2;
    }

    int v = 0;

    if (pos / bitcount >= 10000)
        return 0;

    if (a[pos / bitcount] / (x[pos % bitcount]) % 2 != d)
    {

        if (a[pos / bitcount] / (x[pos % bitcount]) % 2 == 0)
            if (d == 1)

                v = x[pos % bitcount];

        if (a[pos / bitcount] / x[pos % bitcount] % 2 == 1)

            if (d == 0)

                v = v - x[pos % bitcount];
    }

    a[pos / bitcount] = a[pos / bitcount] + v;

    return 0;
}

int seed[3] = {19971231, 19981013, 1000000000 + 7};

int staticvalue = 0;
int rand()
{
    staticvalue = staticvalue * seed[0] + seed[1];
    staticvalue = staticvalue % seed[2];
    if (staticvalue < 0)
        staticvalue = seed[2] + staticvalue;
    return staticvalue;
}

int a[10000] = {};
int main()
{

    freopen("bitset.in", "r", stdin); // int n = getint();
    int n;
    scanf("%d", &n); // staticvalue = getint();
    scanf("%d", &staticvalue);
    clock_t start = clock();
    int x, y;
    while (n > 0)
    {

        n = n - 1;

        x = rand() % 300000;

        y = rand() % 2;

        set(a, x, y);
    }
    clock_t finish = clock();
    printf("%.3f ", (double)(finish - start) / CLOCKS_PER_SEC); // putarray(10000, a);
    return 0;
}
```

1. åœ¨ set å‡½æ•°ä¸­ï¼Œbitcount è¢«è®¾ç½®ä¸ºå¸¸é‡ 30ï¼Œè¿™ä¸ªå€¼åœ¨å‡½æ•°ä¸­æ²¡æœ‰æ”¹å˜ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨`#define bitcount 30`ï¼Œä½¿å¾—åœ¨ç¼–è¯‘æ—¶è®¡ç®—æ‰€æœ‰ä½¿ç”¨ bitcount çš„è¡¨è¾¾å¼ï¼Œè€Œä¸æ˜¯åœ¨è¿è¡Œæ—¶è®¡ç®—
2. å¯ä»¥å°† set å‡½æ•°ä¸­çš„ while å±•å¼€å‡å°‘å¾ªç¯æ§åˆ¶çš„å¼€é”€
3. å¯ä»¥å°† rand å‡½æ•°å†…è”å‡å°‘è°ƒç”¨å¼€é”€
4. `a[pos/bitcount]`å’Œ`(x[pos%bitcount])%2`è¢«å¤šæ¬¡è®¡ç®—ï¼Œå¯ä»¥å°†ç»“æœå­˜å‚¨åœ¨å˜é‡ä¸­
